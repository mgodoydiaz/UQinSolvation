# Uncertainty Quantification in solvation energy of molecules due to atom position

## Abstract

The Poisson and Poisson-Boltzmann equation allow us to describe electrostatic interactions of a molecule inserted in an ionic solution. Through the implicit solvent model and boundary element method it is possible to estimate parameters of interest such as the solvation energy or electrostatic free energy of a molecule by having information of the position and charge of the solute atoms. The position of these atoms is empirically represented and has a degree of uncertainty due to measurement and molecular vibrations that cause thermal properties.

The purpose of this work is to quantify uncertainty generated by the position of the solute atoms in the solvation energy of molecules. For this, several models of random generation of atom positions (shake) were implemented and statistical parameters were calculated using the Monte Carlo method. The results obtained by three shake models are reported: atoms move randomly within spheres of constant radius, according their connectivity, and within spheres of radius according to their mass. The data show that this methodology works to quantify uncertainty and find relationships between variables that may be related to the objectives of this work.

## Instalation
 
This project uses a legacy version of bem_electrostatics. The updated library can be found in the pbj repository, its installation, environment and required libraries can be found in detail at [pbj repository](https://github.com/bem4solvation/pbj/)

## Shake models

### Spherical Shake

Takes a molecule and randomly moves the atoms within a sphere of constant radius. The radius of the sphere is defined by the user.

To run the spherical shake experiment, run the following command:

```python M1-montecarlo_simulation.py```

### Linked Shake

Takes a molecule and depending the bonding information of the atoms, starts putting randomly with three variables: the distance of separation of the atoms and the limits of the polar and azimuthal angles.

To run the linked shake experiment, run the following command:

```python M2-montecarlo_simulation.py```

### Thermal Shake

Based on the average thermal length of an atom, this model shakes the atoms within a sphere of radius equal to the thermal length of the atom. This is based on Maxwell-Boltzmann probability distribution of gas velocity, the following equations lead to:

$$v_t = \sqrt{\frac{k_B \cdot T}{m}}$$

where $v_t$ is the thermal velocity, kB is the Boltzmann constant, $T$ is the temperature (298 K) and m is the mass of the atom.

The average thermal length is a concept that uses a charasteristic time searched on this work. The average thermal length is defined as:

$$\text{ATL} = t_c \cdot \sqrt{\frac{k_B \cdot T}{m}}$$

where $t_c$ is the charasteristic time.

To run the thermal shake experiment, run the following command:

```python characteristic_time_search.py```
